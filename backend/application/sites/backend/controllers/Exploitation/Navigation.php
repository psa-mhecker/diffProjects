<?php
/**
 * Menu de gauche affichant l'arborescence des fonctionnalités disponibles pour l'onglet courant.
 *
 * @author Raphaël Carles <rcarles@businessdecision.com>
 *
 * @since 05/05/2004
 */
class Exploitation_Navigation_Controller extends Pelican_Controller
{
    public function indexAction()
    {
        $directory = Pelican_Cache::fetch("Backend/Cache", Pelican::$config["TEMPLATE_CACHE_ROOT"]."/");

        $directory[0] = array(
            "id" => "X",
            "lib" => "Racine",
            "order" => 1,
        );
        $directory[1] = array(
            "id" => "X1",
            "pid" => "X",
            "lib" => "Classes",
            "order" => 1,
            "url" => "javascript:menu(34, 'list')",
        );
        $directory[2] = array(
            "id" => "X2",
            "pid" => "X",
            "lib" => "Global",
            "order" => 2,
            "url" => "javascript:menu(34)",
        );

        // Affichage de la hiérarchie
        $oTree = Pelican_Factory::getInstance('Hierarchy.Tree', "dtree".$_GET["view"].$_SESSION[APP]['SITE_ID'], "id", "pid");
        $oTree->addTabNode($directory);
        $oTree->setOrder("order", "ASC");
        $oTree->setTreeType("dtree");
        $return = $oTree->getTree();

        $this->getView()->default = "<script type=\"text/javascript\">
		dtree".$_GET["view"].$_SESSION[APP]['SITE_ID'].".doDefault(top.initTree);
		top.initTree=false;
		</script>";

        $this->setResponse($return);
    }
}
