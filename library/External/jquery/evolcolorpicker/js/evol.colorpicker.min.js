/*
   evol.colorpicker 3.2.3
   (c) 2015 Olivier Giulieri
   http://evoluteur.github.io/colorpicker/
*/
!function(t,e){var o=0,s=window.navigator.userAgent,n=s.indexOf("MSIE ")>0,r=n?"-ie":"",c=n?!1:/mozilla/.test(s.toLowerCase())&&!/webkit/.test(s.toLowerCase()),f=[],a=["c00000","ff0000","ffc000","ffff00","92d050","00b050","00b0f0","0070c0","002060","7030a0","c00000","ff0000","ffc000","ffff00","92d050","00b050","00b0f0","0070c0","002060","7030a0"],l=[["003366","336699","3366cc","003399","000099","0000cc","000066"],["006666","006699","0099cc","0066cc","0033cc","0000ff","3333ff","333399"],["669999","009999","33cccc","00ccff","0099ff","0066ff","3366ff","3333cc","666699"],["339966","00cc99","00ffcc","00ffff","33ccff","3399ff","6699ff","6666ff","6600ff","6600cc"],["339933","00cc66","00ff99","66ffcc","66ffff","66ccff","99ccff","9999ff","9966ff","9933ff","9900ff"],["006600","00cc00","00ff00","66ff99","99ffcc","ccffff","ccccff","cc99ff","cc66ff","cc33ff","cc00ff","9900cc"],["003300","009933","33cc33","66ff66","99ff99","ccffcc","ffffff","ffccff","ff99ff","ff66ff","ff00ff","cc00cc","660066"],["333300","009900","66ff33","99ff66","ccff99","ffffcc","ffcccc","ff99cc","ff66cc","ff33cc","cc0099","993399"],["336600","669900","99ff33","ccff66","ffff99","ffcc99","ff9999","ff6699","ff3399","cc3399","990099"],["666633","99cc00","ccff33","ffff66","ffcc66","ff9966","ff6666","ff0066","d60094","993366"],["a58800","cccc00","ffff00","ffcc00","ff9933","ff6600","ff0033","cc0066","660033"],["996633","cc9900","ff9900","cc6600","ff3300","ff0000","cc0000","990033"],["663300","996600","cc3300","993300","990000","800000","993333"]],h="#0000ffff",d=function(t){var e=t.toString(16);return 1==e.length&&(e="0"+e),e},p=function(t){return d(Number(t))},v=function(t){var e=d(t);return e+e+e},u=function(t){if(t.length>10){var e=1+t.indexOf("("),o=t.indexOf(")"),i=t.substring(e,o).split(",");return["#",p(i[0]),p(i[1]),p(i[2])].join("")}return t};t.widget("evol.colorpicker",{version:"3.2.1",options:{color:null,showOn:"both",hideButton:!1,displayIndicator:!0,transparentColor:!1,history:!0,webColor:!0,defaultPalette:"theme",strings:"Theme Colors,Standard Colors,Web Colors,Theme Colors,Back to Palette,History,No history yet.,Standard Colors2",standardColor:!1,color1:a,color2:a,color3:a},_active:!1,_create:function(){var e=this;switch(this._paletteIdx="theme"==this.options.defaultPalette?1:2,this._id="evo-cp"+o++,this._enabled=!0,this.options.showOn=this.options.hideButton?"focus":this.options.showOn,this.element.get(0).tagName){case"INPUT":var i=this.options.color,s=this.element,f=("focus"===this.options.showOn?"":"evo-pointer ")+"evo-colorind"+(c?"-ff":r)+(this.options.hideButton?" evo-hidden-button":""),a="";this._isPopup=!0,this._palette=null;var l=s.val();null!==i?i!=l&&s.val(i).change():""!==l&&(i=this.options.color=l),i===h?f+=" evo-transparent":a=null!==i?"background-color:"+i:"",s.addClass("colorPicker "+this._id).wrap('<div style="width:'+(this.options.hideButton?this.element.width():this.element.width()+32)+"px;"+(n?"margin-bottom:-21px;":"")+(c?"padding:1px 0;":"")+'" class="evo-cp-wrap"></div>').after('<div class="'+f+'" style="'+a+'"></div>').on("keyup onpaste",function(o){var i=t(this).val();i!=e.options.color&&e._setValue(i,!0)});var d=this.options.showOn;("both"===d||"focus"===d)&&s.on("focus",function(){e.showPalette()}),("both"===d||"button"===d)&&s.next().on("click",function(t){return t.stopPropagation(),e.showPalette(),!1});break;default:this._isPopup=!1,this._palette=this.element.html(this._paletteHTML()).attr("aria-haspopup","true"),this._bindColors()}if(this.options.history&&(i&&this._add2History(i),this.options.initialHistory)){var p=this.options.initialHistory;for(var v in p)this._add2History(p[v])}},_paletteHTML:function(){var t=this._paletteIdx=Math.abs(this._paletteIdx),e=this.options,o=e.strings.split(","),i='<div class="evo-pop'+r+' ui-widget ui-widget-content ui-corner-all"'+(this._isPopup?' style="position:absolute"':"")+"><span>"+this["_paletteHTML"+t]()+"</span>";return i+=e.hideWebColor?'<div class="evo-more"><a href="javascript:void(0)">'+o[1+t]+"</a>":"<br>",e.history&&(i+='<a href="javascript:void(0)" class="evo-hist">'+o[5]+"</a>"),i+="</div>",e.displayIndicator&&(i+=this._colorIndHTML(this.options.color)+this._colorIndHTML("")),i+="</div>"},_colorIndHTML:function(t){var e=n?"evo-colorbox-ie ":"",o="";return t?t===h?e+="evo-transparent":o="background-color:"+t:o="display:none",'<div class="evo-color" style="float:left"><div style="'+o+'" class="'+e+'"></div><span>'+(t?t:"")+"</span></div>"},_paletteHTML1:function(){var t=this.options,e=t.strings.split(","),o='<td style="background-color:#',s=n?'"><div style="width:2px;"></div></td>':'"><span/></td>',c='<tr><th colspan="10" class="ui-widget-content">',f='<table class="evo-palette'+r+'">'+c+e[0]+"</th></tr><tr>",a=0;if(t.color1.length>0)for(i=0;i<t.color1.length;i++)10==a&&(f+='<tr><th colspan="10"></th></tr>',a=0),f+=o+t.color1[i]+s,a++;f+="</tr>"+c,t.transparentColor&&(f+='<div class="evo-transparent evo-tr-box"></div>'),f+=e[1]+"</th></tr><tr>";var a=0;if(t.color2.length>0)for(i=0;i<t.color2.length;i++)10==a&&(f+='<tr><th colspan="10"></th></tr>',a=0),f+=o+t.color2[i]+s,a++;f+="</tr>"+c,f+=e[7]+"</th></tr><tr>";var a=0;if(t.color3.length>0)for(i=0;i<t.color3.length;i++)10==a&&(f+='<tr><th colspan="10"></th></tr>',a=0),f+=o+t.color3[i]+s,a++;return f+="</tr></table>"},_paletteHTML2:function(){for(var t,e,o='<td style="background-color:#',i=n?'"><div style="width:5px;"></div></td>':'"><span/></td>',s='<table class="evo-palette2'+r+'"><tr>',c="</tr></table>",f='<div class="evo-palcenter">',a=0,h=l.length;h>a;a++){f+=s;var d=l[a];for(t=0,e=d.length;e>t;t++)f+=o+d[t]+i;f+=c}f+='<div class="evo-sep"/>';var p="";for(f+=s,t=255;t>10;t-=10)f+=o+v(t)+i,t-=10,p+=o+v(t)+i;return f+=c+s+p+c+"</div>"},_switchPalette:function(e){if(this._enabled){var o,i,s,n=this.options.strings.split(",");if(t(e).hasClass("evo-hist")){var r=['<table class="evo-palette"><tr><th class="ui-widget-content">',n[5],"</th></tr></tr></table>",'<div class="evo-cHist">'];if(0===f.length)r.push("<p>&nbsp;",n[6],"</p>");else for(var c=f.length-1;c>-1;c--)9===f[c].length?r.push('<div class="evo-transparent"></div>'):r.push('<div style="background-color:',f[c],'"></div>');r.push("</div>"),o=-this._paletteIdx,i=r.join(""),s=n[4]}else this._paletteIdx<0?(o=-this._paletteIdx,this._palette.find(".evo-hist").show()):o=2==this._paletteIdx?1:2,i=this["_paletteHTML"+o](),s=n[o+1],this._paletteIdx=o;this._paletteIdx=o;var a=this._palette.find(".evo-more").prev().html(i).end().children().eq(0).html(s);0>o&&a.next().hide()}},_downOrUpPositioning:function(){for(var t=this.element,e=0;null!==t&&100>e;){if("visible"!=t.css("overflow")){var o=this._palette.offset().top+this._palette.height(),i=t.offset().top+t.height(),s=this._palette.offset().top-this._palette.height()-this.element.outerHeight(),n=t.offset().top,r=o>i&&s>n;r?this._palette.css({bottom:this.element.outerHeight()+"px"}):this._palette.css({bottom:"auto"});break}if("HTML"==t[0].tagName)break;t=t.offsetParent(),e++}},showPalette:function(){if(this._enabled&&(this._active=!0,t(".colorPicker").not("."+this._id).colorpicker("hidePalette"),null===this._palette)){this._palette=this.element.next().after(this._paletteHTML()).next().on("click",function(t){return t.stopPropagation(),!1}),this._bindColors();var e=this;this._isPopup&&(this._downOrUpPositioning(),t(document.body).on("click."+e._id,function(t){t.target!=e.element.get(0)&&e.hidePalette()}).on("keyup."+e._id,function(t){27===t.keyCode&&e.hidePalette()}))}return this},hidePalette:function(){if(this._isPopup&&this._palette){t(document.body).off("click."+this._id);var e=this;this._palette.off("mouseover click","td,.evo-transparent").fadeOut(function(){e._palette.remove(),e._palette=e._cTxt=null}).find(".evo-more a").off("click")}return this},_bindColors:function(){var e=this,o=this.options,i=this._palette.find("div.evo-color"),s=o.history?"td,.evo-cHist>div":"td";o.transparentColor&&(s+=",.evo-transparent"),this._cTxt1=i.eq(0).children().eq(0),this._cTxt2=i.eq(1).children().eq(0),this._palette.on("click",s,function(o){if(e._enabled){var i=t(this);e._setValue(i.hasClass("evo-transparent")?h:u(i.attr("style").substring(17))),e._active=!1}}).on("mouseover",s,function(o){if(e._enabled){var i=t(this),s=i.hasClass("evo-transparent")?h:u(i.attr("style").substring(17));e.options.displayIndicator&&e._setColorInd(s,2),e._active&&e.element.trigger("mouseover.color",s)}}).find(".evo-more a").on("click",function(){e._switchPalette(this)})},val:function(t){return"undefined"==typeof t?this.options.color:(this._setValue(t),this)},_setValue:function(t,e){t=t.replace(/ /g,""),this.options.color=t,this._isPopup?(e||this.hidePalette(),this._setBoxColor(this.element.val(t).change().next(),t)):this._setColorInd(t,1),this.options.history&&this._paletteIdx>0&&this._add2History(t),this.element.trigger("change.color",t)},_setColorInd:function(t,e){var o=this["_cTxt"+e];this._setBoxColor(o,t),o.next().html(t)},_setBoxColor:function(t,e){e===h?t.addClass("evo-transparent").removeAttr("style"):t.removeClass("evo-transparent").attr("style","background-color:"+e)},_setOption:function(t,e){"color"==t?this._setValue(e,!0):this.options[t]=e},_add2History:function(t){for(var e=f.length,o=0;e>o;o++)if(t==f[o])return;e>27&&f.shift(),f.push(t)},clear:function(){this.hidePalette().val("")},enable:function(){var t=this.element;return this._isPopup?t.removeAttr("disabled"):t.css({opacity:"1","pointer-events":"auto"}),"focus"!==this.options.showOn&&this.element.next().addClass("evo-pointer"),t.removeAttr("aria-disabled"),this._enabled=!0,this},disable:function(){var t=this.element;return this._isPopup?t.attr("disabled","disabled"):(this.hidePalette(),t.css({opacity:"0.3","pointer-events":"none"})),"focus"!==this.options.showOn&&this.element.next().removeClass("evo-pointer"),t.attr("aria-disabled","true"),this._enabled=!1,this},isDisabled:function(){return!this._enabled},destroy:function(){t(document.body).off("click."+this._id),this._palette&&(this._palette.off("mouseover click","td,.evo-cHist>div,.evo-transparent").find(".evo-more a").off("click"),this._isPopup&&this._palette.remove(),this._palette=this._cTxt=null),this._isPopup&&this.element.next().off("click").remove().end().off("focus").unwrap(),this.element.removeClass("colorPicker "+this.id).empty(),t.Widget.prototype.destroy.call(this)}})}(jQuery);