;var VirtualKeyboard=new function(){var i=this;i.$VERSION$=" $HeadURL: https://svn.debugger.ru/repos/jslibs/Virtual%20Keyboard/tags/VirtualKeyboard.v3.5.1/virtualkeyboard.js $ ".match(/\/[^\.]*[\.\/]([^\/]+)\/[\w\.\s$]+$/)[1]+"."+(" $Rev: 476 $ ".replace(/\D/g,""));var I={'layout':null};var l='kb_b';var o=true;var O={14:'backspace',15:'tab',28:'enter',29:'caps',41:'shift_left',52:'shift_right',53:'del',54:'ctrl_left',55:'alt_left',56:'space',57:'alt_right',58:'ctrl_right'};var Q={'SHIFT':'shift','ALT':'alt','CTRL':'ctrl','CAPS':'caps'};var _;var c={'QWERTY Standard':"À1234567890m=ÜQWERTYUIOPÛÝASDFGHJKL;ÞZXCVBNM¼¾¿",'QWERTY Canadian':"Þ1234567890m=ÜQWERTYUIOPÛÝASDFGHJKL;ÀZXCVBNM¼¾¿",'QWERTY Dutch':"Þ1234567890Û¿ÜQWERTYUIOPÝ;ASDFGHJKL=ÀZXCVBNM¼¾m",'QWERTY Estonian':"¿1234567890m=ÜQWERTYUIOPÞÛASDFGHJKL;ÀZXCVBNM¼¾Ý",'QWERTY Greek (220)':"À1234567890¿ÛÜQWERTYUIOP=ÝASDFGHJKL;ÞZXCVBNM¼¾m",'QWERTY Greek (319)':"À1234567890¿=ÜQWERTYUIOPÛÝASDFGHJKL;ÞZXCVBNM¼¾m",'QWERTY Gujarati':"À1234567890m=XQWERTYUIOPÛÝASDFGHJKL;ÜZXCVBNM¼¾¿",'QWERTY Italian':"Ü1234567890ÛÝ¿QWERTYUIOP;=ASDFGHJKLÀÞZXCVBNM¼¾m",'QWERTY Kannada':"À1234567890m=ZQWERTYUIOPÛÝASDFGHJKL;ÞZXCVBNM¼¾¿",'QWERTY Portuguese':"À1234567890ÛÝ¿QWERTYUIOP=;ASDFGHJKLÞÜZXCVBNM¼¾m",'QWERTY Scandinavian':"Ü1234567890=Û¿QWERTYUIOPÝ;ASDFGHJKLÀÞZXCVBNM¼¾m",'QWERTY Spanish':"Ü1234567890mÛ¿QWERTYUIOPÝ;ASDFGHJKLÀÞZXCVBNM¼¾ß",'QWERTY Tamil':"À1234567890m =ZQWERTYUIOPÛÝASDFGHJKL;ÞCVBNM¼¾ ¿",'QWERTY Turkish':"À1234567890ßm¼QWERTYUIOPÛÝASDFGHJKL;ÞZXCVBNM¿Ü¾",'QWERTY UK':"ß1234567890m=ÞQWERTYUIOPÛÝASDFGHJKL;ÀZXCVBNM¼¾¿",'QWERTZ Albanian':"À1234567890m=ÜQWERTZUIOPÛÝASDFGHJKL;ÞYXCVBNM¼¾¿",'QWERTZ Bosnian':"À1234567890¿=ÜQWERTZUIOPÛÝASDFGHJKL;ÞYXCVBNM¼¾m",'QWERTZ Czech':"À1234567890=¿ÜQWERTZUIOPÛÝASDFGHJKL;ÞYXCVBNM¼¾m",'QWERTZ German':"Ü1234567890ÛÝ¿QWERTZUIOP;=ASDFGHJKLÀÞYXCVBNM¼¾m",'QWERTZ Hungarian':"0123456789À¿=ÜQWERTZUIOPÛÝASDFGHJKL;ÞYXCVBNM¼¾m",'QWERTZ Slovak':"À1234567890¿ßÜQWERTZUIOPÛÝASDFGHJKL;ÞYXCVBNM¼¾m",'QWERTZ Swiss':"Ü1234567890ÛÝßQWERTZUIOP;ÞASDFGHJKLÀ¿YXCVBNM¼¾m",'AZERTY Belgian':"Þ1234567890ÛmÜAZERTYUIOPÝ;QSDFGHJKLMÀWXCVBN¼¾¿=",'AZERTY French':"Þ1234567890Û=ÜAZERTYUIOPÝ;QSDFGHJKLMÀWXCVBN¼¾¿ß",',WERTY Bulgarian':"À1234567890m¾Ü¼WERTYUIOPÛÝASDFGHJKL;ÞZXCVBNMßQ¿",'QGJRMV Latvian':"À1234567890mFÜQGJRMVNZWXYH;USILDATECÞÛBÝKPOß¼¾¿",'/,.PYF UK-Dvorak':"m1234567890ÛÝÜÀ¼¾PYFGCRL¿=AOEUIDHTNSÞ;QJKXBMWVZ",'FG;IOD Turkish F':"À1234567890=mXFG;IODRNHPQWUÛEAÝTKMLYÞJÜVC¿ZSB¾¼",';QBYUR US-Dvorak':"7ÛÝ¿PFMLJ4321Ü;QBYURSO¾65=mKCDTHEAZ8ÞÀXGVWNI¼09",'56Q.OR US-Dvorak':"m1234JLMFP¿ÛÝÜ56Q¾ORSUYB;=78ZAEHTDCKÞ90X¼INWVGÀ"};var C=0,v=0,V=1,x=2,X=4,z=8,Z=x|X,w=x|V,W=V|z,s=V|x|X|z;var S=[["\u0384","\u03b1\u03ac \u03b5\u03ad \u03b9\u03af \u03bf\u03cc \u03b7\u03ae \u03c5\u03cd \u03c9\u03ce "+"\u0391\u0386 \u0395\u0388 \u0399\u038a \u039f\u038c \u0397\u0389 \u03a5\u038e \u03a9\u038f"],["\u0385","\u03c5\u03b0 \u03b9\u0390"],["\xb4","a\xe1 A\xc1 e\xe9 E\xc9 i\xed I\xcd o\xf3 O\xd3 u\xfa U\xda y\xfd Y\xdd "+"c\u0107 C\u0106 l\u013a L\u0139 n\u0144 N\u0143 r\u0155 R\u0154 s\u015b S\u015a w\u1e83 W\u1e82 z\u017a Z\u0179"],["\xa8","a\xe4 A\xc4 e\xeb E\xcb i\xef I\xcf j\u0135 J\u0134 "+"o\xf6 O\xd6 u\xfc U\xdc y\xff Y\u0178 w\u1e85 W\1e84 "+"\u03c5\u03cb \u03b9\u03ca \u03a5\u03ab \u0399\u03aa"],["\x5e","a\xe2 A\xc2 e\xea E\xca i\xee I\xce o\xf4 O\xd4 u\xfb U\xdb y\u0176 Y\u0177 "+"c\u0109 C\u0108 h\u0125 H\u0124 g\u011d G\u011c s\u015d S\u015c w\0175 W\0174 "+"\u0131\xee \u0130\xce "],["\x60","a\xe0 A\xc0 e\xe8 E\xc8 i\xec I\xcc o\xf2 O\xd2 u\xf9 U\xd9 y\u1ef3 Y\u1ef2 w\u1e81 W\u1e80"],["\x7e","a\xe3 A\xc3 o\xf5 O\xd5 u\u0169 U\u0168 n\xf1 N\xd1 y\u1ef8 Y\1ef7"],["\xb0","a\xe5 A\xc5 u\u016f U\u016e"],["\u02c7","e\u011b E\u011a "+"c\u010d C\u010c d\u010f D\u010e l\u013e L\u013d n\u0148 N\u0147 "+"r\u0158 R\u0158 s\u0161 S\u0160 t\u0165 T\u0164 z\u017e Z\u017d"],["\u02db","a\u0105 A\u0104 e\u0119 E\u0118 i\u012f I\u012e c\u010b C\u010a g\u0121 G\u0120 u\u0173 U\u0172"],["\u02d9","e\u0117 E\u0116 u0131i I\u0130 z\u017c Z\u017b"],["\xb7","e\u0117 E\u0116 u0131i I\u0130 z\u017c Z\u017b"],["\u02d8","a\u0103 A\u0102 e\u0115 E\u0114 o\0u14f O\0u14e G\u011f g\u011e"],["\u02dd","o\u0151 O\u0150 U\u0170 u\u0171"],["\xb8","c\xe7 C\xc7 g\u0123 G\u0122 k\u0137 K\u0136 l\u013c L\u013b "+"n\u0146 N\u0145 r\u0157 R\u0156 S\u015e s\u015f T\u0162 t\u0163"]];var k={'buttonUp':'kbButton','buttonDown':'kbButtonDown','buttonHover':'kbButtonHover','buttonNormal':'normal','buttonShifted':'shifted','buttonAlted':'alted','capslock':'capsLock','deadkey':'deadKey','noanim':'VK_no_animate'};var K=null;var q=[];q.hash={};var E={keyboard:null,desk:null,langbox:null,attachedInput:null};var r=null;i.addLayout=function(e){var G=e.code.entityDecode().split("-"),h=e.name.entityDecode(),H=P(e.keys);if(!isArray(H)||47!=H.length)throw new Error('VirtualKeyboard requires \'keys\' property to be an array with 47 items, '+H.length+' detected. Layout code: '+G+', layout name: '+h);e.code=(G[1]||G[0]);e.name=h;e.keys=H;e.domain=G[0];h=e.code+" "+h;if(!q.hash.hasOwnProperty(h)){q.hash[h]=q.length;e.toString=function(){return this.code+" "+this.name};q.push(e);}if(e.cbk&&isFunction(e.cbk.load))e.cbk.load.call(this);};i.switchLayout=function(e){if(!q.hash.hasOwnProperty(e))return false;i.IME.hide();if(q.length!=E.langbox.options.length)p();E.langbox.options[q.hash[e]].selected=true;K=q[q.hash[e]];if(!isArray(K))K=q[q.hash[e]]=a(K);E.desk.innerHTML=F(K);var G=E.desk.getElementsByTagName("*");for(var h=0,H=G.length;h<H;h++){G[h].unselectable="on"}E.desk.className=K.domain;i.IME.css=K.domain;C=v;if(isFunction(K.activate)){K.activate();}U();return true};i.getLayouts=function(){var e=[];for(var G=0,h=q.length;G<h;G++){e[e.length]=[q[G].code,q[G].name]}return e.sort();};var R=function(G,h){var H="",j=false;G=G.replace(l,"");switch(G){case Q.CAPS:case Q.SHIFT:case"shift_left":case"shift_right":case Q.ALT:case"alt_left":case"alt_right":return true;case'backspace':if(isFunction(K.charProcessor)&&DocumentSelection.getSelection(E.attachedInput).length){H="\x08"}else if(h){i.IME.hide(true);return true}else{DocumentSelection.deleteAtCursor(E.attachedInput,false);i.IME.hide(true);}break;case'del':i.IME.hide(true);if(h)return true;DocumentSelection.deleteAtCursor(E.attachedInput,true);break;case'space':H=" ";break;case'tab':H="\t";break;case'enter':H="\n";break;default:var J=document.getElementById(l+G);try{H=(J.firstChild.childNodes[Math.min(C&(w),x)].firstChild||J.firstChild.firstChild.firstChild).nodeValue;H=H.replace("\xa0","").replace("\xa0","");}catch(err){return}if(((C&z)>>3)^(C&V))H=H.toUpperCase();break}if(H){if(!(H=f(H,DocumentSelection.getSelection(E.attachedInput))))return j;try{if(H[1]||H[0].length>1||H.charCodeAt(0)>0x7fff||E.attachedInput.contentDocument||'\t'==H[0]){throw new Error}var L=H[0].charCodeAt(0);if(isFunction(document.createEvent)){var h=null;try{h=document.createEvent("KeyEvents");h.initKeyEvent('keypress',false,true,E.attachedInput.contentWindow,false,false,false,false,0,L);}catch(ex){h=document.createEvent("KeyboardEvents");h.initKeyEvent('keypress',false,true,E.attachedInput.contentWindow,false,false,false,false,L,0);}h.VK_bypass=true;E.attachedInput.dispatchEvent(h);}else{h.keyCode=10==L?13:L;j=true}}catch(e){DocumentSelection.insertAtCursor(E.attachedInput,H[0]);if(H[1]){DocumentSelection.setRange(E.attachedInput,-H[1],0,true);}}}return j};var t=function(e){if(!i.isOpen())return;var G=C;var h=e.getKeyCode();switch(e.type){case'keydown':switch(h){case 37:if(i.IME.isOpen()){i.IME.prevPage(e);return}break;case 39:if(i.IME.isOpen()){i.IME.nextPage(e);return}break;case 8:case 9:case 46:var H=E.desk.childNodes[_[h]];if(o&&!e.getRepeat())DOM.CSS(H).addClass(k.buttonDown);if(!R(H.id,e))e.preventDefault();break;case 20:if(!e.getRepeat()){G=G^z}break;case 27:if(i.IME.isOpen()){i.IME.hide();}else{VirtualKeyboard.close();}return false;default:if(!e.getRepeat()){G=G|e.shiftKey|e.ctrlKey<<2|e.altKey<<1}if(_.hasOwnProperty(h)){if(!(e.altKey^e.ctrlKey)){var H=E.desk.childNodes[_[h]];if(o)DOM.CSS(H).addClass(k.buttonDown);r=H.id}if(e.altKey&&e.ctrlKey){e.preventDefault();if(e.srcElement){R(E.desk.childNodes[_[h]].id,e);r=""}}}else{i.IME.hide();}break}break;case'keyup':switch(h){case 20:break;default:if(!e.getRepeat()){G=C&(s^(!e.shiftKey|(!e.ctrlKey<<2)|(!e.altKey<<1)));}if(o&&_.hasOwnProperty(h)){DOM.CSS(E.desk.childNodes[_[h]]).removeClass(k.buttonDown);}}break;case'keypress':if(r&&!e.VK_bypass){if(!R(r,e)){e.stopPropagation();e.preventDefault();}r=null}if(!C^Z&&(e.altKey||e.ctrlKey)){i.IME.hide();}if(0==h&&!r&&!e.VK_bypass&&(!e.ctrlKey&&!e.altKey&&!e.shiftKey)){e.preventDefault();}}if(G!=C){A(G);__updateLayout();}};var T=function(e){var G=DOM.getParent(e.srcElement||e.target,'a');if(!G||G.parentNode.id.indexOf(l)<0)return;G=G.parentNode;switch(G.id.substring(l.length)){case"caps":case"shift_left":case"shift_right":case"alt_left":case"alt_right":case"ctrl_left":case"ctrl_right":return}if(DOM.CSS(G).hasClass(k.buttonDown)){R(G.id);}if(o){DOM.CSS(G).removeClass(k.buttonDown)}var h=C&(z|e.shiftKey|e.altKey<<1|e.ctrlKey<<2);if(C!=h){A(h);__updateLayout();}};var y=function(e){var G=DOM.getParent(e.srcElement||e.target,'a');if(!G||G.parentNode.id.indexOf(l)<0)return;G=G.parentNode;var h=C;var H=G.id.substring(l.length);switch(H){case"caps":h=h^z;break;case"shift_left":case"shift_right":if(e.shiftKey)break;h=h^V;break;case"alt_left":case"alt_right":case"ctrl_left":case"ctrl_right":h=h^(e.altKey<<1^x)^(e.ctrlKey<<2^X);break;default:if(o)DOM.CSS(G).addClass(k.buttonDown);break}if(C!=h){A(h);__updateLayout();}e.preventDefault();e.stopPropagation();};var Y=function(e){var G=DOM.getParent(e.srcElement||e.target,'a'),h={'mouseover':2,'mouseout':3};if(!G||G.parentNode.id.indexOf(l)<0)return;G=G.parentNode;if(G.id.indexOf('shift')>-1){d(h[e.type],Q.SHIFT);}else if(G.id.indexOf('alt')>-1||G.id.indexOf('ctrl')>-1){d(h[e.type],Q.CTRL);d(h[e.type],Q.ALT);}else if(o){D(h[e.type],null,G.id);if('mouseout'==e.type.toLowerCase()){D(0,null,G.id);}}e.preventDefault();e.stopPropagation();};var u=function(e){_=c[e.target.value]};i.attachInput=function(e){if(!e)return E.attachedInput;if(isString(e))e=document.getElementById(e);if(e==E.attachedInput)return E.attachedInput;if(!K)i.switchLayout(I.layout)||i.switchLayout(q[0].toString());if(!K)throw new Error('No layouts available');i.detachInput();if(!e||!e.tagName){E.attachedInput=null}else{o=!DOM.CSS(e).hasClass(k.noanim);U();if(e.contentWindow){e=e.contentWindow.document.body.parentNode}EM.addEventListener(e,'keydown',t);EM.addEventListener(e,'keyup',t);EM.addEventListener(e,'keypress',t);EM.addEventListener(e,'mousedown',i.IME.blurHandler);E.attachedInput=e}return E.attachedInput};i.detachInput=function(){if(!E.attachedInput)return false;U(true);i.IME.hide();if(E.attachedInput){var e=E.attachedInput;if(e.contentWindow){e=e.contentWindow.document.body.parentNode}EM.removeEventListener(e,'keydown',t);EM.removeEventListener(e,'keypress',t);EM.removeEventListener(e,'keyup',t);EM.removeEventListener(e,'mousedown',i.IME.blurHandler);}E.attachedInput=null;return true};i.getAttachedInput=function(e){return E.attachedInput};i.open=i.show=function(e,G,h){if(!(e=i.attachInput(E.attachedInput||e))||!E.keyboard||!document.body)return false;if(!E.keyboard.parentNode||E.keyboard.parentNode.nodeType==11){if(isString(G))G=document.getElementById(G);if(!G.appendChild)return false;G.appendChild(E.keyboard);if(!isUndefined(h)&&e!=h&&h.appendChild){EM.addEventListener(h,'keydown',t);EM.addEventListener(h,'keyup',t);EM.addEventListener(h,'keypress',t);}}return true};i.close=i.hide=function(){if(!E.keyboard||!i.isOpen())return false;i.detachInput();E.keyboard.parentNode.removeChild(E.keyboard);return true};i.toggle=function(e,G,h){i.isOpen()?i.close():i.show(e,G,h);};i.isOpen=function(){return(!!E.keyboard.parentNode)&&E.keyboard.parentNode.nodeType==1};var U=function(e){if(E.attachedInput){var C=e?"":(K.rtl?'rtl':'ltr');if(E.attachedInput.contentWindow)E.attachedInput.contentWindow.document.body.dir=C;else E.attachedInput.dir=C}};var p=function(){var e=q.sort(),G,h,H,j={};q.hash={};E.langbox.innerHTML="";for(var J=0,L=e.length;J<L;J++){G=q[J];if(j.label!=G.code){j=document.createElement('optgroup');j.label=G.code;E.langbox.appendChild(j);}H=G.code+" "+G.name;h=document.createElement('option');h.value=H;h.appendChild(document.createTextNode(G.name));h.label=G.name;j.appendChild(h);q.hash[H]=J}};var P=function(e){if(isString(e))return e.match(/\x01.+?\x02|./g).map(function(G){return G.replace(/[\x01-\x03]/g,"")});else return e.map(function(G){return isArray(G)?G.map(String.fromCharCode).join(""):String.fromCharCode(G)});};var a=function(e){var G=e.keys,h=e.shift||{},H=e.alt||{},j=e.dk||[],J=e.cbk,L=null,b=-1,B=null,n=-1,N=[];N.name=e.name;N.code=e.code;for(var m=0,M=G.length;m<M;m++){if(h.hasOwnProperty(m)){B=P(h[m]);n=m}if(H.hasOwnProperty(m)){L=P(H[m]);b=m}N[m]=[G[m],(n>-1&&B.hasOwnProperty(m-n)?B[m-n]:null),(b>-1&&L.hasOwnProperty(m-b)?L[m-b]:null)]}for(var m in O){if(O.hasOwnProperty(m)){N.splice(m,0,O[m]);}}N.dk=P(j);N.rtl=!!N.toString().match(/[\u05b0-\u06ff]/);N.domain=e.domain;if(isFunction(J)){N.charProcessor=J}else if(J){N.activate=J.activate;N.charProcessor=J.charProcessor}return N};__updateLayout=function(){var e=-1,G=0,h=[k.buttonNormal,k.buttonShifted,k.buttonAlted];if((C&Z)==Z){G=2}else if(C&V){G=1}DOM.CSS(E.desk).removeClass(h).addClass(h[G]);if(o){if(((C&z)>>3)^(C&V)){DOM.CSS(E.desk).addClass(k.capslock);}else{DOM.CSS(E.desk).removeClass(k.capslock);}}for(var H=0,j=K.length;H<j;H++){if(isString(K[H]))continue;e++;var J=document.getElementById(l+e).firstChild.childNodes;if(J[G].firstChild&&J[G].firstChild.nodeValue.length){DOM.CSS(J[0]).removeClass(h).addClass(h[G]);DOM.CSS(J[1]).removeClass(h).addClass([k.buttonShifted,k.buttonNormal,k.buttonShifted][G]);DOM.CSS(J[2]).removeClass(h).addClass([k.buttonAlted,k.buttonAlted,k.buttonNormal][G]);}}};var A=function(e){var G=C^e;if(G&V){d(!!(e&V),Q.SHIFT);}if(G&x){d(!!(e&x),Q.ALT);}if(G&X){d(!!(e&X),Q.CTRL);}if(G&z){D(!!(e&z),Q.CAPS);}C=e};var d=function(e,G){var h=document.getElementById(l+G+'_left'),H=document.getElementById(l+G+'_right');switch(0+e){case 0:h.className=DOM.CSS(H).removeClass(k.buttonDown).getClass();break;case 1:h.className=DOM.CSS(H).addClass(k.buttonDown).getClass();break;case 2:h.className=DOM.CSS(H).addClass(k.buttonHover).getClass();break;case 3:h.className=DOM.CSS(H).removeClass(k.buttonHover).getClass();break}};var D=function(e,G,h){var H=document.getElementById(G?l+G:h);if(H){switch(0+e){case 0:DOM.CSS(H).removeClass(k.buttonDown);break;case 1:DOM.CSS(H).addClass(k.buttonDown);break;case 2:DOM.CSS(H).addClass(k.buttonHover);break;case 3:DOM.CSS(H).removeClass(k.buttonHover);break}}};var f=function(e,G){var h=[];if(isFunction(K.charProcessor)){h=K.charProcessor(e,G);}else if(e=="\x08"){h=['',0]}else{var H=G.charAt(0);if(G.length==1&&K.dk.indexOf(H)>-1){h[1]=e!=H&K.dk.indexOf(e)>-1;h[0]=S[H][e]?S[H][e]:e}else{h[1]=K.dk.indexOf(e)>-1&&S.hasOwnProperty(e);h[0]=e}}return h};var F=function(K){var e=document.createElement('span');document.body.appendChild(e);e.style.position='absolute';e.style.left='-1000px';for(var G=0,h=K.length,H=[],j=0,J;G<h;G++){J=K[G];H.push("<div id='",l,(isArray(J)?j++:J),"' class='",k.buttonUp,"'><a href='#",G,"'",">",(isArray(J)?(g(K,J[0],k.buttonNormal,e)+g(K,J[1],k.buttonShifted,e)+g(K,J[2],k.buttonAlted,e)):"<!-- -->"),"</a></div>");}document.body.removeChild(e);return H.join("");};var g=function(e,G,h,H){var j=[],J=isArray(e.dk)&&e.dk.indexOf(G)>-1,L=0;if(J)h=h+" "+k.deadkey;H.innerHTML=G;if(G&&H.offsetWidth<4)H.innerHTML="\xa0"+G+"\xa0";j[L++]="<span";if(h){j[L++]=" class=\""+h+"\""}j[L++]=" >"+(G?H.innerHTML:"")+"</span>";return j.join("");};(function(){var e={};for(var G=0,h=S.length;G<h;G++){if(!S.hasOwnProperty(G))continue;e[S[G][0]]={};var H=S[G][1].split(" ");for(var j=0,J=H.length;j<J;j++){e[S[G][0]][H[j].charAt(0)]=H[j].charAt(1);}}S=e;E.keyboard=document.createElement('div');E.keyboard.id='virtualKeyboard';E.keyboard.innerHTML="<div id=\"kbDesk\"><!-- --></div>"+"<select id=\"kb_langselector\"></select>"+"<select id=\"kb_mappingselector\"></select>"+'<div id="copyrights" nofocus="true"><a href="http://debugger.ru/projects/virtualkeyboard" target="_blank">VirtualKeyboard '+i.$VERSION$+'</a><br />&copy; 2006-2008 <a href="http://debugger.ru" target="_blank">Debugger.ru</a></div>';E.desk=E.keyboard.firstChild;var L=E.keyboard.childNodes.item(1);EM.addEventListener(L,'change',function(iI){i.switchLayout(this.value)});E.langbox=L;var L=L.nextSibling;var b="";for(var G in c){var B=c[G].split("").map(function(iI){return iI.charCodeAt(0)});B.splice(14,0,8,9);B.splice(28,0,13,20);B.splice(41,0,16);B.splice(52,0,16,46,17,18,32,18,17);var n=B;B=[];for(var j=0,N=n.length;j<N;j++){B[n[j]]=j}c[G]=B;n=G.split(" ",2);if(b.indexOf(b=n[0])!=0){L.appendChild(document.createElement('optgroup'));L.lastChild.label=b}B=document.createElement('option');L.lastChild.appendChild(B);B.value=G;B.innerHTML=n[1]}_=c['QWERTY Standard'];EM.addEventListener(L,'change',u);EM.addEventListener(E.desk,'mousedown',y);EM.addEventListener(E.desk,'mouseup',T);EM.addEventListener(E.desk,'mouseover',Y);EM.addEventListener(E.desk,'mouseout',Y);EM.addEventListener(E.desk,'click',EM.preventDefaultAction);var m=E.keyboard.getElementsByTagName("*");for(var G=0,M=m.length;G<M;G++){m[G].unselectable="on"}E.keyboard.onmousedown=function(iI){if(!iI||!iI.target.tagName||'select'!=iI.target.tagName.toLowerCase())return false};var ii=getScriptQuery('virtualkeyboard.js');if(ii.layout){I.layout=ii.layout}})();};VirtualKeyboard.Langs={};VirtualKeyboard.IME=new function(){var i=this;var I="<div id=\"VirtualKeyboardIME\"><table><tr><td class=\"IMEControl\"><div class=\"left\"><!-- --></div></td>"+"<td class=\"IMEControl IMEContent\"></td>"+"<td class=\"IMEControl\"><div class=\"right\"><!-- --></div></td></tr>"+"<tr><td class=\"IMEControl IMEInfo\" colspan=\"3\"><div class=\"showAll\"><div class=\"IMEPageCounter\"></div><div class=\"arrow\"></div></div></td></tr></div>";var l=null;var o="";var O=0;var Q=false;var _=[];var c=null;var C=null;i.show=function(x){c=VirtualKeyboard.getAttachedInput();var X=DOM.getWindow(c);if(C!=X){if(l&&l.parentNode){l.parentNode.removeChild(l);}C=X;V();C.document.body.appendChild(l);}l.className=i.css;if(x)i.setSuggestions(x);if(c&&l&&_.length>0){EM.addEventListener(c,'blur',i.blurHandler);l.style.display="block";i.updatePosition(c);}else if('none'!=l.style.display){i.hide();}};i.hide=function(x){if(l&&'none'!=l.style.display){l.style.display="none";EM.removeEventListener(c,'blur',i.blurHandler);if(c&&DocumentSelection.getSelection(c)&&!x)DocumentSelection.deleteSelection(c);c=null;_=[]}};i.updatePosition=function(){var x=DOM.getOffset(c);l.style.left=x.x+'px';var X=DocumentSelection.getSelectionOffset(c);l.style.top=x.y+X.y+X.h+'px'};i.setSuggestions=function(x){if(!isArray(x))return false;_=x;O=0;e();i.updatePosition(c);};i.getSuggestions=function(x){return isNumber(x)?_[x]:_};i.nextPage=function(x){O=Math.max(Math.min(O+1,(Math.ceil(_.length/10))-1),0);e();if(x){x.stopPropagation();x.preventDefault();return false}};i.prevPage=function(x){O=Math.max(O-1,0);e();if(x){x.stopPropagation();x.preventDefault();return false}};i.getPage=function(){return O};i.getChar=function(x){x=--x<0?9:x;return _[i.getPage()*10+x]};i.isOpen=function(){return l&&'block'==l.style.display};i.blurHandler=function(x){i.hide();};i.toggleShowAll=function(x){var X=l.firstChild.rows[1].cells[0].lastChild;if(Q=!Q){O=0;X.className='showPage'}else{X.className='showAll'}e();if(x){x.stopPropagation();x.preventDefault();return false}};var e=function(){var x=['<table>'];if(Q){for(var X=0,z=Math.ceil(_.length/10);X<z;X++){x.push('<tr>');for(var Z=0,w=X*10;Z<10&&!isUndefined(_[w+Z]);Z++){x.push("<td><a href=''>");if(0==X){x.push("<b>&nbsp;"+((Z+1)%10)+": </b>");}x.push(_[w+Z]+"</a></td>");}x.push('</tr>');}}else{x.push('<tr>');for(var Z=0,w=O*10;Z<10&&!isUndefined(_[w+Z]);Z++){x.push("<td><a href=''><b>&nbsp;"+((Z+1)%10)+": </b>"+_[w+Z]+"</a></td>");}x.push('</tr>');}x.push('</table>');l.firstChild.rows[0].cells[1].innerHTML=x.join("");l.firstChild.rows[1].cells[0].firstChild.firstChild.innerHTML=(O+1)+"/"+(0+Q||Math.ceil(_.length/10));var W=l.getElementsByTagName("*");for(var Z=0,s=W.length;Z<s;Z++){W[Z].unselectable="on"}};var v=function(x){var X=DOM.getParent(x.target,'a');if(X){DocumentSelection.insertAtCursor(c,X.lastChild.nodeValue);i.hide();}x.preventDefault();};var V=function(){var x=C.document.createElement('div');x.innerHTML=I;l=x.firstChild;l.style.display='none';var X=l.firstChild.rows[0].cells[0],z=l.firstChild.rows[0].cells[2],Z=l.firstChild.rows[1].cells[0].lastChild;EM.addEventListener(X,'mousedown',i.prevPage);EM.addEventListener(z,'mousedown',i.nextPage);EM.addEventListener(Z,'mousedown',i.toggleShowAll);l.unselectable="on";var w=l.getElementsByTagName("*");for(var W=0,s=w.length;W<s;W++){w[W].unselectable="on"}EM.addEventListener(l,'mousedown',v);}};
